(function(n,q){function g(a,c){if(1==arguments.length)return _.isArray(a)&&2==a.length?new e(a[0],a[1]):_.isObject(a)&&_.has(a,"x")&&_.has(a,"y")?new e(a.x,a.y):g(a,{});if(2==arguments.length&&!_.isObject(a)&&!_.isObject(c))return new e(a,c);var b;_.isString(a)?(b=document.createElementNS("http://www.w3.org/2000/svg",a),"svg"===a&&b.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink")):_.isObject(a)&&(b=a);_.each(c,function(a,c){"href"==c?b.setAttributeNS("http://www.w3.org/1999/xlink",
"href",a):"xlink:"==c.substr(0,6)?b.setAttributeNS("http://www.w3.org/1999/xlink",c.substr(6),a):b.setAttribute(c,a)});for(var d=2;d<arguments.length;++d)_.isArray(arguments[d])?arguments.callee.apply(this,[b,{}].concat(arguments[d])):_.isObject(arguments[d])?b.appendChild(arguments[d]):_.isUndefined(arguments[d])||b.appendChild(document.createTextNode(arguments[d]));return b}function e(a,c){_.has(a,"x")&&_.has(a,"y")?(this.x=a.x,this.y=a.y):_.isArray(a)&&2==a.length?(this.x=a[0],this.y=a[1]):(this.x=
a||0,this.y=c||0)}function h(a){return function(c,b){if(1==arguments.length){if(_.isArray(c))return a.call(this,new e(c[0],c[1]));if(_.isObject(c))return a.call(this,c)}else if(2==arguments.length&&!_.isObject(c)&&!_.isObject(b))return a.call(this,new e(c,b));throw Error(arguments.length+" arguments, possibly wrong type");}}function f(a){var c=function(b){return _.has(a,b)};c("from")&&(a.from=new e(a.from));c("to")&&(a.to=new e(a.to));_.each(["a1","a2","aspan","minspan"],function(b){c(b+"d")&&!c(b)&&
(a[b]=a[b+"d"]/k)});!c("aspan")&&c("a1")&&c("a2")&&(a.aspan=a.a2-a.a1);_.defaults(a,{minspan:p});var b=a.aspan;c("cx")&&c("cy")&&!c("center")&&(a.center=new e(a.cx,a.cy));if(c("center")&&(!c("from")||!c("to"))){var d=new e(a.center);a.from=d.add((new e(a.r)).rotate(a.a1));a.to=d.add((new e(a.r)).rotate(a.a2))}if(Math.abs(b)<=a.minspan)return d=a.to.sub(a.from).mul(1/(3*Math.pow(Math.cos(b/4),2))),[[a.from,a.from.add(d.rotate(-b/2)),a.to.sub(d.rotate(b/2)),a.to]];if(_.has(a,"center"))return d={center:a.center,
r:a.r,a1:a.a1,a2:a.a2},f(_.extend({},d,{a2:a.a1+b/2})).concat(f(_.extend({},d,{a1:a.a2-b/2})));d={from:a.from,to:a.to,aspan:b/2};b=a.to.sub(a.from).rotate($v.rfd(-90)).mul(.5*Math.tan(b/4));b=a.to.add(a.from).mul(.5).add(b);return f(_.extend({},d,{to:b})).concat(f(_.extend({},d,{from:b})))}function l(a){a=parseFloat(a);return(Math.round(1E3*a)/1E3).toString()}function m(a){return _.foldl(a,function(a,b){_.isNumber(b)?b=l(b):_.isObject(b)?_.isArray(b)?b=m(b):_.has(b,"x")&&_.has(b,"y")&&(b=l(b.x)+" "+
l(b.y)):b=b.toString();return a+(0<a.length&&0<="0123456789".indexOf(a.substr(-1,1))&&0<b.length&&0<="0123456789".indexOf(b.substr(0,1))?" ":"")+b},"")}var k=180/Math.PI;_.extend(e.prototype,{add:h(function(a){return new e(this.x+a.x,this.y+a.y)}),sub:h(function(a){return new e(this.x-a.x,this.y-a.y)}),dot:h(function(a){return this.x*a.x+this.y*a.y}),mul:function(a){return new e(this.x*a,this.y*a)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},argument:function(){return Math.atan2(this.y,
this.x)},rotate:function(a){var c=Math.cos(a);a=Math.sin(a);return new e(this.x*c-this.y*a,this.x*a+this.y*c)},rename:function(a,c){if(0==arguments.length)return[this.x,this.y];if(1==arguments.length){if(_.isArray(a))return this.rename.apply(this,a);c=a.replace("x","y")}var b={};b[a]=this.x;b[c]=this.y;return b}});_.each([["scale","mul"],["direction","argument"],["dir","argument"],["ren","rename"]],function(a){e.prototype[a[0]]=e.prototype[a[1]]});var p=Math.PI/4;_.extend(g,{normalize:h,path:m,string:m,
rfd:function(a){return a/k},dfr:function(a){return a*k},arcpath:function(a,c){var b=[],d;if(_.isString(a))d=f(c),b.push(a,d[0][0]);else if(_.isObject(a)&&1==arguments.length)d=f(a);else return;_.each(d,function(a){b.push("C",a.slice(1))});return b},polar:function(a,c){return new e(a*Math.cos(c),a*Math.sin(c))}});n.planeLib=g;n.$v=g})(this);
